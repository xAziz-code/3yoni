<!doctype html>
<html lang="hu">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>3yoni3Leek2</title>
  <style>
    :root{
      --panel: rgba(12,14,18,0.95);
      --panel2: rgba(20,22,28,0.96);
      --text: #eaf0ff;
      --muted:#98a6b7;
      --accent:#2a86ff;
      --row:#1a1f27;
      --rowActive: rgba(42,134,255,0.20);
      --w: 360px;
      --row-h: 36px;
      --r: 10px;
      --shadow: 0 14px 40px rgba(0,0,0,.55);
    }
    *{ box-sizing:border-box; user-select:none; -webkit-user-select:none; font-family: Arial, Helvetica, sans-serif; }
    html,body{ margin:0; background:transparent; color:var(--text); }

    .dock{
      position: fixed; right: 36px; top: 50%; transform: translateY(-50%);
      width: var(--w); max-width: calc(100vw - 40px);
      border-radius: var(--r); background: var(--panel);
      box-shadow: var(--shadow); overflow: hidden;
    }
    .hidden{ display:none !important; }

    .header{
      padding: 12px 14px;
      background:
        linear-gradient(180deg, rgba(255,255,255,0.05), rgba(255,255,255,0)),
        radial-gradient(140px 70px at 85% 0%, rgba(42,134,255,0.35), transparent 70%);
    }
    .banner{
      width: 100%; height: 60px; object-fit: cover;
      border-radius: 8px; margin-bottom: 8px; display:block;
    }
    .brand{ font-size:22px; font-weight:800; letter-spacing:.4px; }

    .list{ background: var(--panel2); padding: 10px; }
    .row{
      height: var(--row-h); line-height: var(--row-h); padding: 0 12px; margin-bottom: 6px;
      border-radius: 6px; background: var(--row); border: 1px solid transparent;
      display:flex; align-items:center; justify-content:space-between; font-size: 14px;
      transition: background .12s, border-color .12s, box-shadow .12s;
    }
    .row:last-child{ margin-bottom:0; }
    .row .label{ white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .row .hint{ color:var(--muted); font-size:12px; }
    .row.active{ background: var(--rowActive); border-color: var(--accent);
      box-shadow: inset 0 0 0 1px rgba(42,134,255,0.25); }

    .overlay{
      position:absolute; inset:0; background: rgba(12,14,18,0.98);
      transform: translateX(100%); transition: transform .16s ease-out;
      display:flex; flex-direction:column;
    }
    .overlay.open{ transform: translateX(0); }
    .ov-head{ padding:12px 14px; display:flex; justify-content:space-between; }
    .ov-title{ font-weight:700; }
  </style>
</head>
<body>
  <div id="menu" class="dock hidden" tabindex="-1" aria-hidden="true">
    <div class="header" style="overflow:hidden; border-radius:10px 10px 0 0;">
      <img src="./banner.png?v=2" class="banner" alt="banner" onerror="this.style.display='none'">
      <div class="brand" id="brand">Discord.gg/D99</div>
    </div>

    <div class="list" id="list"></div>

    <div class="overlay" id="overlay">
      <div class="ov-head"><div class="ov-title" id="ovTitle">Submenu</div></div>
      <div class="list" id="subList"></div>
    </div>
  </div>

  <script>
    const MODEL = {
      title: 'Discord.gg/D99',
      items: [
        {label:'animation', hasSub:true, hint:'›'},
        {label:'Vehicle', hasSub:true, hint:'›'},
        {label:'Add', hasSub:true, hint:'›'},
        {label:'Settings', hasSub:true, hint:'›'}
      ],
      index: 0,
      submenuOpen: false,
      subItems: [],
      subIndex: 0
    };

    const menu   = document.getElementById('menu');
    const list   = document.getElementById('list');
    const brand  = document.getElementById('brand');
    const overlay= document.getElementById('overlay');
    const ovTitle= document.getElementById('ovTitle');
    const subList= document.getElementById('subList');

    const norm = x => typeof x === 'string' ? {label:x} : x;

    function show(){ menu.classList.remove('hidden'); menu.removeAttribute('aria-hidden'); }
    function hide(){ menu.classList.add('hidden'); menu.setAttribute('aria-hidden','true'); }

    function render(){
      brand.textContent = MODEL.title;
      list.innerHTML = '';
      MODEL.items.map(norm).forEach((it, i)=>{
        const row = document.createElement('div');
        row.className = 'row' + (i===MODEL.index ? ' active':'' );
        row.innerHTML = '<div class="label">'+it.label+'</div><div class="hint">'+(it.hint||'')+'</div>';
        list.appendChild(row);
      });
    }

    function renderSub(){
      subList.innerHTML = '';
      MODEL.subItems.map(norm).forEach((it, i)=>{
        const row = document.createElement('div');
        row.className = 'row' + (i===MODEL.subIndex ? ' active':'' );
        row.innerHTML = '<div class="label">'+it.label+'</div><div class="hint">'+(it.hint||'')+'</div>';
        subList.appendChild(row);
      });
    }

    function openSubWith(opts){
      MODEL.submenuOpen = true;
      MODEL.subItems = Array.isArray(opts.items) ? opts.items : [];
      MODEL.subIndex = Number.isInteger(opts.index) ? opts.index : 0;
      ovTitle.textContent = opts.title || 'Submenu';
      overlay.classList.add('open');
      renderSub();
    }

    window.addEventListener('message', (event)=>{
      const d = event.data || {};

      if (d.type==='show') return show();
      if (d.type==='hide') return hide();

      if (d.type==='init'){
        if (d.title) MODEL.title=d.title;
        if (Array.isArray(d.items)) MODEL.items=d.items;
        MODEL.index = (typeof d.index==='number')? d.index : 0;
        render(); show(); return;
      }

      if (d.type==='setTitle' && d.title){ MODEL.title=d.title; render(); }
      if (d.type==='setItems' && Array.isArray(d.items)){ MODEL.items=d.items; render(); }
      if (d.type==='setIndex' && Number.isInteger(d.index)){
        MODEL.index=Math.max(0,Math.min(MODEL.items.length-1,d.index)); render();
      }
      if (d.type==='move' && typeof d.delta==='number'){
        if (!MODEL.submenuOpen){
          const max=MODEL.items.length-1;
          MODEL.index=Math.min(max,Math.max(0,MODEL.index+d.delta));
          render();
        }
      }
      if (d.type==='openSub'){ MODEL.submenuOpen=true; overlay.classList.add('open'); }
      if (d.type==='closeSub'){ MODEL.submenuOpen=false; overlay.classList.remove('open'); }

      // الجدد للـ animation submenu
      if (d.type==='openSubWith'){ openSubWith(d); }
      if (d.type==='moveSub' && typeof d.delta==='number'){
        const max = MODEL.subItems.length-1;
        MODEL.subIndex = Math.min(max, Math.max(0, MODEL.subIndex + d.delta));
        renderSub();
      }
      if (d.type==='setSubIndex' && Number.isInteger(d.index)){
        const max = MODEL.subItems.length-1;
        MODEL.subIndex = Math.min(max, Math.max(0, d.index));
        renderSub();
      }
    });

    // لا نفعّل مستمع لوحة المفاتيح هنا لتجنب التعارض مع اللعبة
    render();
  </script>
</body>
</html>
